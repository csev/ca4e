<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CDC6504 CPU Documentation</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            line-height: 1.6;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        
        .container {
            background: white;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        h1 {
            color: #2c3e50;
            border-bottom: 3px solid #3498db;
            padding-bottom: 10px;
        }
        
        h2 {
            color: #34495e;
            border-bottom: 2px solid #ecf0f1;
            padding-bottom: 5px;
            margin-top: 30px;
        }
        
        h3 {
            color: #2c3e50;
            margin-top: 25px;
        }
        
        .instruction-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            font-family: 'Courier New', monospace;
            font-size: 14px;
        }
        
        .instruction-table th {
            background-color: #3498db;
            color: white;
            padding: 12px;
            text-align: left;
            border: 1px solid #2980b9;
        }
        
        .instruction-table td {
            padding: 10px;
            border: 1px solid #ddd;
            vertical-align: top;
        }
        
        .instruction-table tr:nth-child(even) {
            background-color: #f8f9fa;
        }
        
        .code-block {
            background-color: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 4px;
            padding: 15px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            overflow-x: auto;
            margin: 15px 0;
            white-space: pre;
            line-height: 1.4;
        }
        
        .register-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        
        .register-card {
            background: #ecf0f1;
            padding: 15px;
            border-radius: 5px;
            border-left: 4px solid #3498db;
        }
        
        .register-card h4 {
            margin: 0 0 10px 0;
            color: #2c3e50;
        }
        
        .error-table {
            background-color: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 4px;
            padding: 15px;
            margin: 20px 0;
        }
        
        .error-table h3 {
            color: #856404;
            margin-top: 0;
        }
        
        .tip {
            background-color: #d1ecf1;
            border: 1px solid #bee5eb;
            border-radius: 4px;
            padding: 15px;
            margin: 15px 0;
        }
        
        .tip h4 {
            color: #0c5460;
            margin-top: 0;
        }
        
        .example {
            background-color: #d4edda;
            border: 1px solid #c3e6cb;
            border-radius: 4px;
            padding: 15px;
            margin: 15px 0;
        }
        
        .example h4 {
            color: #155724;
            margin-top: 0;
        }
        
        .nav-tabs {
            display: flex;
            border-bottom: 2px solid #dee2e6;
            margin-bottom: 20px;
        }
        
        .nav-tab {
            padding: 10px 20px;
            background: none;
            border: none;
            cursor: pointer;
            border-bottom: 2px solid transparent;
        }
        
        .nav-tab.active {
            border-bottom-color: #3498db;
            color: #3498db;
            font-weight: bold;
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>CDC6504 CPU Assembly Language Reference</h1>
        <p style="font-size: 16px; color: #6c757d; margin-bottom: 20px;">
            The CDC6504 is a limited 6502 emulator with PC, ACC, X, Y registers and status flags (Z, N, C). 
            This tool uses authentic 6502 opcodes and instruction syntax.
        </p>
        
        <div class="nav-tabs">
            <button class="nav-tab active" onclick="showTab('instructions')">Instructions</button>
            <button class="nav-tab" onclick="showTab('registers')">Registers</button>
            <button class="nav-tab" onclick="showTab('examples')">Examples</button>
            <button class="nav-tab" onclick="showTab('errors')">Error Handling</button>
            <button class="nav-tab" onclick="showTab('labels')">Labels</button>
            <button class="nav-tab" onclick="showTab('references')">References</button>
        </div>
        
        <div id="instructions" class="tab-content active">
            <h2>Instruction Set Reference</h2>
            
            <h3>Load Instructions</h3>
            <table class="instruction-table">
                <tr>
                    <th>Assembly</th>
                    <th>Opcode</th>
                    <th>Description</th>
                </tr>
                <tr>
                    <td>LDA #value</td>
                    <td>10101001</td>
                    <td>Load accumulator with immediate value (0-255, 0x00-0xFF, or 'A')</td>
                </tr>
                <tr>
                    <td>LDA $address</td>
                    <td>10100101</td>
                    <td>Load accumulator from zero-page memory address</td>
                </tr>
                <tr>
                    <td>LDX #value</td>
                    <td>10100010</td>
                    <td>Load X register with immediate value</td>
                </tr>
                <tr>
                    <td>LDX $address</td>
                    <td>10100110</td>
                    <td>Load X register from zero-page memory address</td>
                </tr>
                <tr>
                    <td>LDY #value</td>
                    <td>10100000</td>
                    <td>Load Y register with immediate value</td>
                </tr>
                <tr>
                    <td>LDY $address</td>
                    <td>10100100</td>
                    <td>Load Y register from zero-page memory address</td>
                </tr>
            </table>
            
            <h3>Store Instructions (Zero Page)</h3>
            <table class="instruction-table">
                <tr>
                    <th>Assembly</th>
                    <th>Opcode</th>
                    <th>Description</th>
                </tr>
                <tr>
                    <td>STA $address</td>
                    <td>10000101</td>
                    <td>Store accumulator to zero-page memory address</td>
                </tr>
                <tr>
                    <td>STX $address</td>
                    <td>10000110</td>
                    <td>Store X register to zero-page memory address</td>
                </tr>
                <tr>
                    <td>STY $address</td>
                    <td>10000100</td>
                    <td>Store Y register to zero-page memory address</td>
                </tr>
            </table>
            
            <h3>Arithmetic Instructions</h3>
            <table class="instruction-table">
                <tr>
                    <th>Assembly</th>
                    <th>Opcode</th>
                    <th>Description</th>
                </tr>
                <tr>
                    <td>ADC #value</td>
                    <td>01101001</td>
                    <td>Add with carry (immediate): ACC = ACC + value + C flag</td>
                </tr>
                <tr>
                    <td>ADC $address</td>
                    <td>01100101</td>
                    <td>Add with carry (from memory): ACC = ACC + memory[address] + C flag</td>
                </tr>
                <tr>
                    <td>SBC #value</td>
                    <td>11101001</td>
                    <td>Subtract with carry (immediate): ACC = ACC - value - (1 - C flag)</td>
                </tr>
                <tr>
                    <td>SBC $address</td>
                    <td>11100101</td>
                    <td>Subtract with carry (from memory): ACC = ACC - memory[address] - (1 - C flag)</td>
                </tr>
                <tr>
                    <td>CMP #value</td>
                    <td>11001001</td>
                    <td>Compare accumulator with immediate value, sets Z, N, C flags</td>
                </tr>
            </table>
            
            <div class="tip">
                <h4>ðŸ’¡ Adding from Another Register</h4>
                <p>To add the value from X or Y register to the accumulator, first transfer the register to accumulator, then add:</p>
                <div class="code-block">
TXA            ; Transfer X to accumulator
ADC #5         ; Add 5 to accumulator (which now contains X's value)
                </div>
                <p>Or store the register to memory first, then load and add:</p>
                <div class="code-block">
STX $10        ; Store X to memory
LDA $10        ; Load X's value into accumulator
ADC #5         ; Add 5
                </div>
            </div>
            
            <h3>Increment/Decrement Instructions</h3>
            <table class="instruction-table">
                <tr>
                    <th>Assembly</th>
                    <th>Opcode</th>
                    <th>Description</th>
                </tr>
                <tr>
                    <td>INX</td>
                    <td>11101000</td>
                    <td>Increment X register by 1</td>
                </tr>
                <tr>
                    <td>INY</td>
                    <td>11001000</td>
                    <td>Increment Y register by 1</td>
                </tr>
                <tr>
                    <td>DEX</td>
                    <td>11001010</td>
                    <td>Decrement X register by 1</td>
                </tr>
                <tr>
                    <td>DEY</td>
                    <td>10001000</td>
                    <td>Decrement Y register by 1</td>
                </tr>
            </table>
            
            <h3>Transfer Instructions</h3>
            <table class="instruction-table">
                <tr>
                    <th>Assembly</th>
                    <th>Opcode</th>
                    <th>Description</th>
                </tr>
                <tr>
                    <td>TAX</td>
                    <td>10101010</td>
                    <td>Transfer accumulator to X register</td>
                </tr>
                <tr>
                    <td>TAY</td>
                    <td>10101000</td>
                    <td>Transfer accumulator to Y register</td>
                </tr>
                <tr>
                    <td>TXA</td>
                    <td>10001010</td>
                    <td>Transfer X register to accumulator</td>
                </tr>
                <tr>
                    <td>TYA</td>
                    <td>10011000</td>
                    <td>Transfer Y register to accumulator</td>
                </tr>
            </table>
            
            <h3>Branch Instructions (Relative)</h3>
            <table class="instruction-table">
                <tr>
                    <th>Assembly</th>
                    <th>Opcode</th>
                    <th>Description</th>
                </tr>
                <tr>
                    <td>BEQ label</td>
                    <td>11110000</td>
                    <td>Branch if equal (Z flag set)</td>
                </tr>
                <tr>
                    <td>BNE label</td>
                    <td>11010000</td>
                    <td>Branch if not equal (Z flag clear)</td>
                </tr>
                <tr>
                    <td>BMI label</td>
                    <td>00110000</td>
                    <td>Branch if minus (N flag set)</td>
                </tr>
                <tr>
                    <td>BPL label</td>
                    <td>00010000</td>
                    <td>Branch if plus (N flag clear)</td>
                </tr>
                <tr>
                    <td>BCS label</td>
                    <td>10110000</td>
                    <td>Branch if carry set (C flag set)</td>
                </tr>
                <tr>
                    <td>BCC label</td>
                    <td>10010000</td>
                    <td>Branch if carry clear (C flag clear)</td>
                </tr>
            </table>
            
            <h3>Jump Instruction</h3>
            <table class="instruction-table">
                <tr>
                    <th>Assembly</th>
                    <th>Opcode</th>
                    <th>Description</th>
                </tr>
                <tr>
                    <td>JMP $address</td>
                    <td>01001100</td>
                    <td>Unconditional jump to absolute address (zero-page)</td>
                </tr>
            </table>
            
            <h3>Control Instructions</h3>
            <table class="instruction-table">
                <tr>
                    <th>Assembly</th>
                    <th>Opcode</th>
                    <th>Description</th>
                </tr>
                <tr>
                    <td>BRK</td>
                    <td>00000000</td>
                    <td>Break/Halt - Stop program execution (automatically prints string from data memory)</td>
                </tr>
            </table>
            
            <h3>Assembly Directives</h3>
            <table class="instruction-table">
                <tr>
                    <th>Assembly</th>
                    <th>Description</th>
                </tr>
                <tr>
                    <td>DATA 'string'</td>
                    <td>Pre-populates data memory (not instruction memory) with a null-terminated string. Data is loaded starting at memory address 0.</td>
                </tr>
                <tr>
                    <td>DATA 0x00 0x0A ...</td>
                    <td>Pre-populates data memory (not instruction memory) with a space-separated list of hexadecimal values. Data is loaded starting at memory address 0.</td>
                </tr>
            </table>
            
            <h3>Comments</h3>
            <p>Comments can be added to assembly code using <code>;</code> (semicolon). Everything from the semicolon to the end of the line is ignored by the assembler.</p>
            <p><strong>Note:</strong> The <code>#</code> character is used for immediate values (e.g., <code>LDA #42</code>), not for comments.</p>
            <div class="code-block">
LDA #42      ; This is a comment using semicolon
LDX #10      ; Comments can appear after instructions
INX          ; Another comment
; This is a comment-only line
BRK
            </div>
        </div>
        
        <div id="registers" class="tab-content">
            <h2>Register Reference</h2>
            
            <div class="register-grid">
                <div class="register-card">
                    <h4>General Purpose Registers</h4>
                    <p>6502 architecture registers</p>
                    <ul>
                        <li><strong>ACC</strong>: Accumulator (A register) - primary register for arithmetic and data operations</li>
                        <li><strong>X</strong>: Index Register X - used for indexing and counting</li>
                        <li><strong>Y</strong>: Index Register Y - used for indexing and counting</li>
                    </ul>
                </div>
                
                <div class="register-card">
                    <h4>Status Flags</h4>
                    <p>Condition flags set by arithmetic and comparison operations</p>
                    <ul>
                        <li><strong>Z</strong>: Zero flag - set when result equals zero</li>
                        <li><strong>N</strong>: Negative flag - set when bit 7 of result is set (signed negative)</li>
                        <li><strong>C</strong>: Carry flag - set on arithmetic overflow/underflow</li>
                    </ul>
                </div>
                
                <div class="register-card">
                    <h4>Special Registers</h4>
                    <ul>
                        <li><strong>PC</strong>: Program Counter (current instruction address)</li>
                        <li><strong>MODE</strong>: Error mode register (0x0 = normal, 0x1 = invalid instruction)</li>
                    </ul>
                </div>
            </div>
            
            <div class="tip">
                <h4>ðŸ’¡ 6502 Architecture</h4>
                <p>The CDC6504 emulates a simplified 6502 processor. The accumulator (ACC) is the primary register for arithmetic operations. Use STA/STX/STY to store registers to memory, and LDA/LDX/LDY to load from immediate values.</p>
            </div>
            
            <div class="tip">
                <h4>ðŸ’¡ ASCII Character Support</h4>
                <p>Immediate values can be specified as single ASCII characters in quotes: <code>LDA #'A'</code> loads 65 (ASCII for 'A') into the accumulator. This works for all immediate instructions: LDA, LDX, LDY, CMP, ADC, SBC.</p>
            </div>
            
            <div class="tip">
                <h4>ðŸ’¡ Status Flags</h4>
                <p>Status flags are automatically updated by arithmetic and comparison operations. Use branch instructions (BEQ, BNE, BMI, BPL, BCS, BCC) to conditionally jump based on flag states.</p>
            </div>
        </div>
        
        <div id="examples" class="tab-content">
            <h2>Example Programs</h2>
            
            <div class="example">
                <h4>Hello World (Manual)</h4>
                <div class="code-block">
LDA #'H'       ; Load 'H' into accumulator
STA $00        ; Store to memory address 0
LDA #'e'       ; Load 'e' into accumulator
STA $01        ; Store to memory address 1
LDA #'l'       ; Load 'l' into accumulator
STA $02        ; Store to memory address 2
STA $03        ; Store 'l' again to address 3
LDA #'o'       ; Load 'o' into accumulator
STA $04        ; Store to memory address 4
BRK            ; Halt (automatically prints string)
                </div>
            </div>
            
            <div class="example">
                <h4>Hello World (with DATA)</h4>
                <div class="code-block">
BRK            ; Stop
DATA 'Hello World!'
                </div>
            </div>
            
            <div class="example">
                <h4>Counter Loop (with Labels)</h4>
                <div class="code-block">
LDX #0         ; Initialize X register to 0
loop:
TXA            ; Transfer X to accumulator
CMP #5         ; Compare accumulator to 5
BEQ end        ; Branch to end if equal (Z flag set)
INX            ; Increment X register
JMP loop       ; Jump back to loop
end:
BRK            ; Stop
                </div>
            </div>
            
            <div class="example">
                <h4>Add with Carry</h4>
                <div class="code-block">
LDA #10        ; Load 10 into accumulator
ADC #5         ; Add 5 with carry (result = 15)
STA $00        ; Store result to memory address 0
BRK
                </div>
            </div>
            
            <div class="example">
                <h4>Register Transfer</h4>
                <div class="code-block">
LDA #42        ; Load 42 into accumulator
TAX            ; Transfer accumulator to X
TXA            ; Transfer X back to accumulator
BRK
                </div>
            </div>
            
            <div class="example">
                <h4>Load from Memory Address</h4>
                <div class="code-block">
; Store a value in memory, then load it into registers
LDA #100       ; Load 100 into accumulator
STA $10        ; Store accumulator to memory address $10
LDA $10        ; Load accumulator from memory address $10
LDX $10        ; Load X register from memory address $10
LDY $10        ; Load Y register from memory address $10
BRK
                </div>
            </div>
            
            <div class="example">
                <h4>Add from Memory Address</h4>
                <div class="code-block">
; Store values in memory, then add them
LDA #10        ; Load 10 into accumulator
STA $20        ; Store to memory address $20
LDA #5         ; Load 5 into accumulator
ADC $20        ; Add value from memory address $20 (result = 15)
STA $21        ; Store result to memory address $21
BRK
                </div>
            </div>
            
            <div class="example">
                <h4>Add from Another Register</h4>
                <div class="code-block">
; To add X register's value to accumulator:
LDX #10        ; Load 10 into X register
TXA            ; Transfer X to accumulator
ADC #5         ; Add 5 to accumulator (now contains X's value + 5)
BRK

; Alternative: Store X to memory, then load and add
LDX #10        ; Load 10 into X register
STX $30        ; Store X to memory address $30
LDA $30        ; Load X's value into accumulator
ADC #5         ; Add 5
BRK
                </div>
            </div>
        </div>
        
        <div id="errors" class="tab-content">
            <h2>Error Handling</h2>
            
            <div class="error-table">
                <h3>Mode Register Error Codes</h3>
                <table class="instruction-table">
                    <tr>
                        <th>Mode</th>
                        <th>Error</th>
                        <th>Trigger</th>
                    </tr>
                    <tr>
                        <td>0x0</td>
                        <td>Normal operation</td>
                        <td>No error</td>
                    </tr>
                    <tr>
                        <td>0x1</td>
                        <td>Invalid instruction</td>
                        <td>Unknown opcode</td>
                    </tr>
                    <tr>
                        <td>0x2</td>
                        <td>Jump address out of range</td>
                        <td>Jump to address â‰¥ 256 (not applicable in zero-page mode)</td>
                    </tr>
                </table>
            </div>
            
            <h3>Error Test Programs</h3>
            
            <div class="example">
                <h4>Test Invalid Instruction (Mode 1)</h4>
                <div class="code-block">
LDA #0
0xFF          ; Invalid instruction (0xFF - undefined opcode)
BRK
                </div>
            </div>
        </div>
        
        <div id="labels" class="tab-content">
            <h2>Label System</h2>
            
            <p>The assembler supports a two-pass label system for easier programming.</p>
            
            <h3>Label Definition</h3>
            <p>Labels are defined by ending a line with a colon (<code>:</code>):</p>
            <div class="code-block">
start:        ; This defines a label called "start"
SET X0, 0
loop:         ; This defines a label called "loop"
INC X0
            </div>
            
            <h3>Label Usage</h3>
            <p>Labels can be used in jump instructions instead of hard-coded addresses:</p>
            <div class="code-block">
SET X0, 0
loop:
CMP X0, 5
JE end        ; Jump to "end" label
INC X0
JL loop       ; Jump back to "loop" label
end:
HALT
            </div>
            
            <h3>Two-Pass Assembly</h3>
            <ol>
                <li><strong>First Pass</strong>: Collects all labels and calculates their addresses</li>
                <li><strong>Second Pass</strong>: Assembles the program with resolved label addresses</li>
            </ol>
            
            <div class="tip">
                <h4>ðŸ’¡ Benefits of Labels</h4>
                <ul>
                    <li>No need to calculate jump addresses manually</li>
                    <li>Adding/removing instructions doesn't break jump addresses</li>
                    <li>More readable and maintainable code</li>
                    <li>Supports both labels and direct addresses</li>
                </ul>
            </div>
        </div>
        
        <div id="references" class="tab-content">
            <h2>External References</h2>
            
            <p>For more information about the 6502 processor and instruction sets, please refer to these external resources:</p>
            
            <ul>
                <li><a href="https://en.wikipedia.org/wiki/MOS_Technology_6502" target="_blank">MOS Technology 6502 - Wikipedia</a></li>
                <li><a href="https://www.masswerk.at/6502/6502_instruction_set.html" target="_blank">6502 Instruction Set Reference</a></li>
                <li><a href="https://en.wikipedia.org/wiki/Assembly_language" target="_blank">Assembly Language - Wikipedia</a></li>
                <li><a href="https://en.wikipedia.org/wiki/CPU_design" target="_blank">CPU Design - Wikipedia</a></li>
                <li><a href="https://en.wikipedia.org/wiki/Instruction_set_architecture" target="_blank">Instruction Set Architecture - Wikipedia</a></li>
            </ul>
            
            <div class="tip">
                <h4>ðŸ’¡ Historical Context</h4>
                <p>The CDC6504 emulator uses authentic 6502 opcodes and instruction syntax. The 6502 was one of the most popular 8-bit microprocessors, used in systems like the Apple II, Commodore 64, and Atari 2600.</p>
            </div>
        </div>
        
        <hr style="margin: 40px 0; border: none; border-top: 2px solid #e9ecef;">
        
        <div style="text-align: center; padding: 20px; background-color: #f8f9fa; border-radius: 8px; margin-top: 30px;">
            <h3 style="color: #2c3e50; margin-bottom: 15px;">About This Tool</h3>
            <p style="margin: 0; color: #6c757d; font-size: 16px;">
                This CDC6504 CPU emulator is part of the <strong>Computer Architecture for Everybody</strong> course, 
                available at <a href="https://www.ca4e.com" target="_blank" style="color: #3498db; text-decoration: none;">www.ca4e.com</a>
            </p>
        </div>
    </div>
    
    <script>
        function showTab(tabName) {
            // Hide all tab contents
            const tabContents = document.querySelectorAll('.tab-content');
            tabContents.forEach(content => content.classList.remove('active'));
            
            // Remove active class from all tabs
            const tabs = document.querySelectorAll('.nav-tab');
            tabs.forEach(tab => tab.classList.remove('active'));
            
            // Show selected tab content
            document.getElementById(tabName).classList.add('active');
            
            // Add active class to clicked tab
            event.target.classList.add('active');
        }
    </script>
</body>
</html>
