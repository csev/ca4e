<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Exercise Classes Test</title>
</head>
<body>
    <h1>Exercise Classes Test</h1>
    
    <div id="test-results"></div>
    
    <script src="exercises.js"></script>
    <script>
        // Mock the required global functions and objects for testing
        window.MisticProbes = {
            getProbeLabels: () => ['A', 'Q'],
            setProbeValue: (probe, value) => console.log(`Set ${probe} to ${value}`),
            getProbeValue: (probe) => probe === 'Q' ? 1 : -1, // Mock successful test
            recompute: () => console.log('Circuit recomputed'),
            resetAllProbes: () => console.log('All probes reset')
        };
        
        // Mock DOM elements
        document.getElementById = (id) => {
            const mockElement = {
                style: { display: 'block' },
                innerHTML: '',
                textContent: '',
                onclick: null
            };
            return mockElement;
        };
        
        // Mock other required functions
        function compute() { console.log('Compute called'); }
        function redrawAllTiles() { console.log('Redraw called'); }
        function closeAssignmentModal() { console.log('Modal closed'); }
        
        // Test the exercise classes
        function runTests() {
            const results = document.getElementById('test-results');
            let testResults = '<h2>Test Results</h2>';
            
            try {
                // Test 1: Create NotGateExercise instance
                const notExercise = new NotGateExercise();
                testResults += '<p>✓ NotGateExercise created successfully</p>';
                
                // Test 2: Check exercise properties
                if (notExercise.name === "NOT Gate Exercise") {
                    testResults += '<p>✓ Exercise name is correct</p>';
                } else {
                    testResults += '<p>✗ Exercise name is incorrect</p>';
                }
                
                if (notExercise.steps.length === 3) {
                    testResults += '<p>✓ Exercise has correct number of steps</p>';
                } else {
                    testResults += '<p>✗ Exercise has incorrect number of steps</p>';
                }
                
                // Test 3: Test step execution
                const step0Result = notExercise.executeStep(0);
                if (step0Result.success) {
                    testResults += '<p>✓ Step 0 (probe check) passed</p>';
                } else {
                    testResults += '<p>✗ Step 0 (probe check) failed: ' + step0Result.error + '</p>';
                }
                
                const step1Result = notExercise.executeStep(1);
                if (step1Result.success) {
                    testResults += '<p>✓ Step 1 (A=GND → Q=VCC) passed</p>';
                } else {
                    testResults += '<p>✗ Step 1 (A=GND → Q=VCC) failed: ' + step1Result.error + '</p>';
                }
                
                const step2Result = notExercise.executeStep(2);
                if (step2Result.success) {
                    testResults += '<p>✓ Step 2 (A=VCC → Q=GND) passed</p>';
                } else {
                    testResults += '<p>✗ Step 2 (A=VCC → Q=GND) failed: ' + step2Result.error + '</p>';
                }
                
                // Test 4: Test NandGateExercise
                const nandExercise = new NandGateExercise();
                testResults += '<p>✓ NandGateExercise created successfully</p>';
                
                if (nandExercise.steps.length === 5) {
                    testResults += '<p>✓ NAND exercise has correct number of steps</p>';
                } else {
                    testResults += '<p>✗ NAND exercise has incorrect number of steps</p>';
                }
                
                // Test 5: Test ExerciseFactory
                const factoryExercise = ExerciseFactory.createExercise('not');
                if (factoryExercise instanceof NotGateExercise) {
                    testResults += '<p>✓ ExerciseFactory creates correct exercise type</p>';
                } else {
                    testResults += '<p>✗ ExerciseFactory creates incorrect exercise type</p>';
                }
                
                testResults += '<p><strong>All tests completed successfully!</strong></p>';
                
            } catch (error) {
                testResults += '<p style="color: red;">✗ Test failed with error: ' + error.message + '</p>';
                console.error('Test error:', error);
            }
            
            results.innerHTML = testResults;
        }
        
        // Run tests when page loads
        document.addEventListener('DOMContentLoaded', runTests);
    </script>
</body>
</html>
